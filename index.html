<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆã‚¨ãƒ‡ã‚£ã‚¿</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .animate-spin {
            animation: spin 1s linear infinite;
        }
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .animate-fadeInUp {
            animation: fadeInUp 0.3s ease-out;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-indigo-500 via-purple-600 to-purple-700 min-h-screen">
    <div id="root" class="min-h-screen p-8">
        <!-- Content will be rendered here -->
    </div>

    <script>
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«çŠ¶æ…‹ç®¡ç†
        const state = {
            markdownText: '',
            parsedItems: [],
            currentFileName: 'checklist.md',
            notification: null,
            notificationTimeout: null
        };

        // å®šæ•°å®šç¾©
        const SAMPLE_MARKDOWN = `# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

## æº–å‚™ãƒ•ã‚§ãƒ¼ã‚º
- [ ] ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è¦ä»¶å®šç¾©ã‚’å®Œäº†ã™ã‚‹
- [ ] ãƒãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼ã®å½¹å‰²ã‚’æ˜ç¢ºã«ã™ã‚‹
- [ ] é–‹ç™ºç’°å¢ƒã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã™ã‚‹
- [ ] GitHubãƒªãƒã‚¸ãƒˆãƒªã‚’ä½œæˆã™ã‚‹

## é–‹ç™ºãƒ•ã‚§ãƒ¼ã‚º
- [ ] åŸºæœ¬çš„ãªæ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹
- [ ] ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’ãƒ‡ã‚¶ã‚¤ãƒ³ã™ã‚‹
- [ ] ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒã‚’è¨­è¨ˆã™ã‚‹
- [ ] APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’ä½œæˆã™ã‚‹

## ãƒ†ã‚¹ãƒˆãƒ•ã‚§ãƒ¼ã‚º
- [ ] å˜ä½“ãƒ†ã‚¹ãƒˆã‚’ä½œæˆã™ã‚‹
- [ ] çµ±åˆãƒ†ã‚¹ãƒˆã‚’å®Ÿæ–½ã™ã‚‹
- [ ] ãƒ¦ãƒ¼ã‚¶ãƒ¼å—å…¥ã‚Œãƒ†ã‚¹ãƒˆã‚’è¡Œã†
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆã‚’å®Ÿæ–½ã™ã‚‹

## ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ•ã‚§ãƒ¼ã‚º
- [ ] æœ¬ç•ªç’°å¢ƒã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã™ã‚‹
- [ ] CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’æ§‹ç¯‰ã™ã‚‹
- [ ] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»ã‚’å®Ÿæ–½ã™ã‚‹
- [ ] ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ä½œæˆã™ã‚‹

---
*æœ€çµ‚æ›´æ–°æ—¥: ${new Date().toLocaleDateString('ja-JP')}*`;

        // ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°
        function parseMarkdownToListItems(markdown) {
            const lines = markdown.split('\n');
            const items = [];
            let currentIndex = 0;

            lines.forEach((line, lineIndex) => {
                const trimmedLine = line.trim();
                
                if (trimmedLine.startsWith('#')) {
                    const level = (line.match(/^#+/) || [''])[0].length;
                    const text = line.replace(/^#+\s*/, '');
                    items.push({
                        type: 'header',
                        level,
                        text,
                        lineIndex,
                        index: currentIndex++
                    });
                } else if (trimmedLine.match(/^- \[[ x]\]/)) {
                    const checked = trimmedLine.includes('- [x]');
                    const text = trimmedLine.replace(/^- \[[ x]\]\s*/, '');
                    items.push({
                        type: 'task',
                        checked,
                        text,
                        lineIndex,
                        index: currentIndex++
                    });
                } else {
                    items.push({
                        type: 'other',
                        text: line,
                        lineIndex,
                        index: currentIndex++
                    });
                }
            });

            return items;
        }

        function updateMarkdownString(markdown, lineIndex, newCheckedState) {
            const lines = markdown.split('\n');
            if (lineIndex >= 0 && lineIndex < lines.length) {
                if (newCheckedState) {
                    lines[lineIndex] = lines[lineIndex].replace('- [ ]', '- [x]');
                } else {
                    lines[lineIndex] = lines[lineIndex].replace('- [x]', '- [ ]');
                }
            }
            return lines.join('\n');
        }

        // é€šçŸ¥é–¢æ•°
        function showNotification(message, type = 'success') {
            if (state.notificationTimeout) {
                clearTimeout(state.notificationTimeout);
            }

            state.notification = { message, type };
            renderNotification();

            state.notificationTimeout = setTimeout(() => {
                state.notification = null;
                renderNotification();
            }, 3000);
        }

        function renderNotification() {
            const notificationContainer = document.getElementById('notification-container');
            if (!notificationContainer) return;

            if (!state.notification) {
                notificationContainer.innerHTML = '';
                return;
            }

            const { message, type } = state.notification;
            const bgColor = type === 'success' ? 'bg-green-500' : 'bg-red-500';
            const icon = type === 'success' ? 'âœ“' : 'âœ•';

            notificationContainer.innerHTML = `
                <div class="fixed top-4 right-4 ${bgColor} text-white px-6 py-3 rounded-lg shadow-lg flex items-center space-x-2 animate-fadeInUp">
                    <span class="text-xl">${icon}</span>
                    <span>${message}</span>
                </div>
            `;
        }

        // ãƒ•ã‚¡ã‚¤ãƒ«å‡¦ç†é–¢æ•°
        function handleFileUpload(file) {
            if (!file) return;

            const reader = new FileReader();
            reader.onload = (e) => {
                state.markdownText = e.target.result;
                state.currentFileName = file.name;
                updateMarkdown();
                showNotification(`ãƒ•ã‚¡ã‚¤ãƒ«ã€Œ${file.name}ã€ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ`);
            };
            reader.onerror = () => {
                showNotification('ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ', 'error');
            };
            reader.readAsText(file);
        }

        function saveMarkdown() {
            const blob = new Blob([state.markdownText], { type: 'text/markdown' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = state.currentFileName;
            a.click();
            URL.revokeObjectURL(url);
            showNotification(`ã€Œ${state.currentFileName}ã€ã‚’ä¿å­˜ã—ã¾ã—ãŸ`);
        }

        // ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ãƒ¼
        function handleTextChange(e) {
            state.markdownText = e.target.value;
            state.parsedItems = parseMarkdownToListItems(state.markdownText);
            
            const outputSection = document.getElementById('output-section');
            if (outputSection) {
                outputSection.innerHTML = renderOutputSection();
            }
        }

        function handleCheckboxToggle(lineIndex, currentChecked) {
            state.markdownText = updateMarkdownString(state.markdownText, lineIndex, !currentChecked);
            updateMarkdown();
        }

        function handleLoadSample() {
            state.markdownText = SAMPLE_MARKDOWN;
            state.currentFileName = 'sample-checklist.md';
            updateMarkdown();
            showNotification('ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ');
        }

        function handleClear() {
            if (confirm('ç¾åœ¨ã®å†…å®¹ã‚’ã‚¯ãƒªã‚¢ã—ã¾ã™ã‹ï¼Ÿ')) {
                state.markdownText = '';
                state.currentFileName = 'checklist.md';
                updateMarkdown();
                showNotification('å†…å®¹ã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸ');
            }
        }

        function handleDragOver(e) {
            e.preventDefault();
            e.currentTarget.classList.add('border-indigo-500', 'bg-indigo-50');
        }

        function handleDragLeave(e) {
            e.currentTarget.classList.remove('border-indigo-500', 'bg-indigo-50');
        }

        function handleDrop(e) {
            e.preventDefault();
            e.currentTarget.classList.remove('border-indigo-500', 'bg-indigo-50');
            
            const file = e.dataTransfer.files[0];
            if (file && (file.type === 'text/markdown' || file.type === 'text/plain' || file.name.endsWith('.md'))) {
                handleFileUpload(file);
            } else {
                showNotification('ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ.mdï¼‰ã¾ãŸã¯ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ.txtï¼‰ã‚’é¸æŠã—ã¦ãã ã•ã„', 'error');
            }
        }

        // æ›´æ–°é–¢æ•°
        function updateMarkdown() {
            state.parsedItems = parseMarkdownToListItems(state.markdownText);
            renderApp();
        }

        // ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°é–¢æ•°
        function renderInputSection() {
            return `
                <div class="bg-white/95 backdrop-blur shadow-2xl rounded-2xl p-8 h-full flex flex-col">
                    <h2 class="text-2xl font-bold mb-6 text-gray-800">ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³å…¥åŠ›</h2>
                    
                    <div class="mb-4 flex flex-wrap gap-2">
                        <button onclick="handleLoadSample()" class="px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors duration-200 flex items-center gap-2">
                            <span>ğŸ“„</span>
                            <span>ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿</span>
                        </button>
                        <button onclick="saveMarkdown()" class="px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors duration-200 flex items-center gap-2">
                            <span>ğŸ’¾</span>
                            <span>ä¿å­˜</span>
                        </button>
                        <button onclick="handleClear()" class="px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors duration-200 flex items-center gap-2">
                            <span>ğŸ—‘ï¸</span>
                            <span>ã‚¯ãƒªã‚¢</span>
                        </button>
                    </div>

                    <div 
                        id="drop-zone"
                        class="flex-1 border-2 border-dashed border-gray-300 rounded-xl p-4 transition-all duration-200"
                        ondragover="handleDragOver(event)"
                        ondragleave="handleDragLeave(event)"
                        ondrop="handleDrop(event)"
                    >
                        <textarea
                            id="markdown-input"
                            class="w-full h-full p-4 font-mono text-sm resize-none outline-none bg-transparent"
                            placeholder="ã“ã“ã«ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ã‚’å…¥åŠ›ã™ã‚‹ã‹ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—ã—ã¦ãã ã•ã„..."
                            oninput="handleTextChange(event)"
                        >${state.markdownText}</textarea>
                    </div>

                    <input
                        type="file"
                        id="file-input"
                        accept=".md,.txt"
                        class="hidden"
                        onchange="handleFileUpload(event.target.files[0])"
                    />
                    <button 
                        onclick="document.getElementById('file-input').click()"
                        class="mt-4 w-full px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors duration-200"
                    >
                        ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ
                    </button>
                </div>
            `;
        }

        function renderOutputSection() {
            const taskItems = state.parsedItems.filter(item => item.type === 'task');
            const checkedCount = taskItems.filter(item => item.checked).length;
            const totalCount = taskItems.length;
            const progress = totalCount > 0 ? (checkedCount / totalCount) * 100 : 0;

            return `
                <div class="bg-white/95 backdrop-blur shadow-2xl rounded-2xl p-8 h-full flex flex-col">
                    <h2 class="text-2xl font-bold mb-6 text-gray-800">ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆè¡¨ç¤º</h2>
                    
                    ${totalCount > 0 ? `
                        <div class="mb-6">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-sm text-gray-600">é€²æ—çŠ¶æ³</span>
                                <span class="text-sm font-medium text-gray-800">${checkedCount} / ${totalCount} å®Œäº†</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-3 overflow-hidden">
                                <div 
                                    class="h-full bg-gradient-to-r from-indigo-500 to-purple-600 transition-all duration-500 rounded-full"
                                    style="width: ${progress}%"
                                ></div>
                            </div>
                        </div>
                    ` : ''}
                    
                    <div class="flex-1 overflow-y-auto space-y-2">
                        ${state.parsedItems.map(item => renderItem(item)).join('')}
                    </div>
                </div>
            `;
        }

        function renderItem(item) {
            if (item.type === 'header') {
                const fontSize = ['text-3xl', 'text-2xl', 'text-xl', 'text-lg', 'text-base', 'text-sm'][item.level - 1] || 'text-base';
                const margin = item.level === 1 ? 'mt-6 mb-4' : 'mt-4 mb-2';
                return `<h${item.level} class="${fontSize} font-bold text-gray-800 ${margin}">${item.text}</h${item.level}>`;
            } else if (item.type === 'task') {
                return `
                    <div class="flex items-start p-3 rounded-lg hover:bg-gray-50 transition-colors duration-150 cursor-pointer group" onclick="handleCheckboxToggle(${item.lineIndex}, ${item.checked})">
                        <input
                            type="checkbox"
                            ${item.checked ? 'checked' : ''}
                            class="mt-1 w-5 h-5 text-indigo-600 rounded focus:ring-indigo-500 focus:ring-2 transition-all duration-200 cursor-pointer"
                            onclick="handleCheckboxToggle(${item.lineIndex}, ${item.checked}); event.stopPropagation();"
                        />
                        <span class="ml-3 text-gray-700 ${item.checked ? 'line-through opacity-60' : ''} group-hover:text-gray-900 transition-all duration-200">
                            ${item.text}
                        </span>
                    </div>
                `;
            } else if (item.text.trim()) {
                if (item.text.trim() === '---') {
                    return '<hr class="my-4 border-gray-300" />';
                }
                return `<p class="text-gray-600 py-1">${item.text}</p>`;
            }
            return '';
        }

        function renderApp() {
            const root = document.getElementById('root');
            root.innerHTML = `
                <div class="container mx-auto flex flex-col h-full">
                    <header class="text-center mb-8">
                        <h1 class="text-4xl font-bold text-white mb-2">ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆã‚¨ãƒ‡ã‚£ã‚¿</h1>
                        <p class="text-white/80">ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³å½¢å¼ã§ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆã‚’ä½œæˆãƒ»ç·¨é›†ã§ãã¾ã™</p>
                    </header>
                    
                    <div class="flex-1 grid grid-cols-1 lg:grid-cols-2 gap-8 min-h-0">
                        <div id="input-section" class="h-full">${renderInputSection()}</div>
                        <div id="output-section" class="h-full">${renderOutputSection()}</div>
                    </div>
                </div>
                <div id="notification-container"></div>
            `;
        }

        // åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', () => {
            renderApp();
        });
    </script>
</body>
</html>